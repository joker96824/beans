# Color Matcher - 颜色匹配工具

一个基于PyQt5的图形化颜色匹配和替换工具，专为数字绘画和图像处理设计。

## 项目简介

Color Matcher是一个功能强大的桌面应用程序，可以帮助用户：
- 将图像中的颜色替换为预定义的颜色调色板
- 支持多种颜色匹配算法（RGB、LAB、HSV）
- 提供直观的图形界面进行颜色编辑
- 支持批量颜色替换和撤销操作
- 生成颜色统计信息

## 功能特性

### 🎨 核心功能
- **图像加载与处理**: 支持常见图像格式的加载和处理
- **颜色匹配**: 多种颜色匹配算法，精确匹配目标颜色
- **实时预览**: 实时显示颜色替换效果
- **批量操作**: 支持批量颜色替换和撤销
- **画笔模式**: 手动选择颜色进行精确编辑

### 🔧 技术特性
- **多算法支持**: RGB、LAB、HSV颜色空间匹配
- **缩放功能**: 支持图像缩放查看
- **统计信息**: 显示颜色使用频率和分布
- **数据导出**: 支持处理结果的保存

## 项目结构

```
beans/
├── color_matcher.py      # 主程序文件
├── requirements.txt      # Python依赖包
├── sample.json          # 示例颜色数据
├── color/               # 颜色配置文件目录
│   ├── Mard144.json     # Mard144颜色调色板
│   └── Mard221.json     # Mard221颜色调色板
└── README.md           # 项目说明文档
```

## 安装要求

### 系统要求
- Windows 10/11
- Python 3.7+

### 依赖包
```
PyQt5==5.15.9
Pillow==10.0.0
numpy==1.24.3
```

## 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd beans
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python color_matcher.py
   ```

## 使用说明

### 基本操作

1. **加载图像**
   - 点击"加载图像"按钮选择要处理的图片文件
   - 支持常见图像格式：PNG、JPG、BMP等

2. **选择颜色源**
   - 从下拉菜单中选择颜色调色板（Mard144、Mard221等）
   - 程序会自动加载对应的颜色配置

3. **颜色匹配**
   - 选择匹配算法（RGB、LAB、HSV）
   - 点击"处理图像"开始颜色匹配

4. **颜色替换**
   - 使用"颜色替换"功能进行批量颜色修改
   - 选择源颜色和目标颜色进行替换

5. **画笔模式**
   - 启用画笔模式进行精确的颜色编辑
   - 点击色块直接修改颜色

### 高级功能

- **缩放控制**: 使用鼠标滚轮进行图像缩放
- **统计信息**: 查看颜色使用频率和分布
- **撤销操作**: 支持撤销最近的颜色修改
- **保存结果**: 保存处理后的图像

## 颜色数据格式

### 输入格式
程序支持两种颜色数据格式：

1. **网格格式** (`sample.json`)
   ```json
   {
     "A1": {
       "rgb": [255, 255, 255],
       "is_placeholder": true
     }
   }
   ```

2. **调色板格式** (`color/*.json`)
   ```json
   {
     "data": [
       {
         "color": "#FAF4C8",
         "colorCode": "A1",
         "displayOrder": 1
       }
     ]
   }
   ```

## 开发说明

### 主要类结构

- `ColorMatcher`: 主窗口类，管理整个应用程序
- `ImageGrid`: 图像网格管理，处理色块数据
- `ColorBlock`: 单个色块类，存储颜色信息
- `ZoomableLabel`: 可缩放的图像显示组件

### 颜色匹配算法

1. **RGB匹配**: 基于欧几里得距离的RGB颜色空间匹配
2. **LAB匹配**: 基于CIELAB颜色空间的感知匹配
3. **HSV匹配**: 基于HSV颜色空间的加权匹配

## 许可证

本项目采用MIT许可证。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 联系方式

如有问题或建议，请通过GitHub Issues联系我们。 